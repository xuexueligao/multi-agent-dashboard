{
  "version": 3,
  "sources": ["../../../../src/cli/lib/init.ts"],
  "sourcesContent": ["import { chalkStderr } from \"chalk\";\nimport { Context } from \"../../bundler/context.js\";\nimport { logFinishedStep, logMessage } from \"../../bundler/log.js\";\nimport { DeploymentType } from \"./api.js\";\nimport { writeUrlsToEnvFile } from \"./envvars.js\";\nimport { getDashboardUrl } from \"./dashboard.js\";\n\nexport async function finalizeConfiguration(\n  ctx: Context,\n  options: {\n    functionsPath: string;\n    deploymentType: DeploymentType;\n    deploymentName: string;\n    url: string;\n    siteUrl: string | null | undefined;\n    wroteToGitIgnore: boolean;\n    changedDeploymentEnvVar: boolean;\n  },\n) {\n  const envFileConfig = await writeUrlsToEnvFile(ctx, {\n    convexUrl: options.url,\n    siteUrl: options.siteUrl,\n  });\n  if (envFileConfig !== null) {\n    logFinishedStep(\n      `${messageForDeploymentType(options.deploymentType, options.url)} and saved its:\\n` +\n        `    name as CONVEX_DEPLOYMENT\\n` +\n        `    Client URL as ${envFileConfig.convexUrlEnvVar}\\n` +\n        (envFileConfig.siteUrlEnvVar\n          ? `    HTTP Actions URL as ${envFileConfig.siteUrlEnvVar}\\n`\n          : \"\") +\n        ` to ${envFileConfig.envFile}`,\n    );\n  } else if (options.changedDeploymentEnvVar) {\n    logFinishedStep(\n      `${messageForDeploymentType(options.deploymentType, options.url)} and saved its name as CONVEX_DEPLOYMENT to .env.local`,\n    );\n  }\n  if (options.wroteToGitIgnore) {\n    logMessage(chalkStderr.gray(`  Added \".env.local\" to .gitignore`));\n  }\n  if (options.deploymentType === \"anonymous\") {\n    logMessage(\n      `Run \\`npx convex login\\` at any time to create an account and link this deployment.`,\n    );\n  }\n\n  const anyChanges =\n    options.wroteToGitIgnore ||\n    options.changedDeploymentEnvVar ||\n    envFileConfig !== null;\n  if (anyChanges) {\n    const dashboardUrl = await getDashboardUrl(ctx, {\n      deploymentName: options.deploymentName,\n      deploymentType: options.deploymentType,\n    });\n    logMessage(\n      `\\nWrite your Convex functions in ${chalkStderr.bold(options.functionsPath)}\\n` +\n        \"Give us feedback at https://convex.dev/community or support@convex.dev\\n\" +\n        `View the Convex dashboard at ${dashboardUrl}\\n`,\n    );\n  }\n}\n\nfunction messageForDeploymentType(deploymentType: DeploymentType, url: string) {\n  switch (deploymentType) {\n    case \"anonymous\":\n      return `Started running a deployment locally at ${url}`;\n    case \"local\":\n      return `Started running a deployment locally at ${url}`;\n    case \"dev\":\n    case \"prod\":\n    case \"preview\":\n    case \"custom\":\n      return `Provisioned a ${deploymentType} deployment`;\n    default: {\n      deploymentType satisfies never;\n      return `Provisioned a ${deploymentType as any} deployment`;\n    }\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAA4B;AAE5B,iBAA4C;AAE5C,qBAAmC;AACnC,uBAAgC;AAEhC,eAAsB,sBACpB,KACA,SASA;AACA,QAAM,gBAAgB,UAAM,mCAAmB,KAAK;AAAA,IAClD,WAAW,QAAQ;AAAA,IACnB,SAAS,QAAQ;AAAA,EACnB,CAAC;AACD,MAAI,kBAAkB,MAAM;AAC1B;AAAA,MACE,GAAG,yBAAyB,QAAQ,gBAAgB,QAAQ,GAAG,CAAC;AAAA;AAAA,oBAEzC,cAAc,eAAe;AAAA,KACjD,cAAc,gBACX,2BAA2B,cAAc,aAAa;AAAA,IACtD,MACJ,OAAO,cAAc,OAAO;AAAA,IAChC;AAAA,EACF,WAAW,QAAQ,yBAAyB;AAC1C;AAAA,MACE,GAAG,yBAAyB,QAAQ,gBAAgB,QAAQ,GAAG,CAAC;AAAA,IAClE;AAAA,EACF;AACA,MAAI,QAAQ,kBAAkB;AAC5B,+BAAW,yBAAY,KAAK,oCAAoC,CAAC;AAAA,EACnE;AACA,MAAI,QAAQ,mBAAmB,aAAa;AAC1C;AAAA,MACE;AAAA,IACF;AAAA,EACF;AAEA,QAAM,aACJ,QAAQ,oBACR,QAAQ,2BACR,kBAAkB;AACpB,MAAI,YAAY;AACd,UAAM,eAAe,UAAM,kCAAgB,KAAK;AAAA,MAC9C,gBAAgB,QAAQ;AAAA,MACxB,gBAAgB,QAAQ;AAAA,IAC1B,CAAC;AACD;AAAA,MACE;AAAA,iCAAoC,yBAAY,KAAK,QAAQ,aAAa,CAAC;AAAA;AAAA,+BAEzC,YAAY;AAAA;AAAA,IAChD;AAAA,EACF;AACF;AAEA,SAAS,yBAAyB,gBAAgC,KAAa;AAC7E,UAAQ,gBAAgB;AAAA,IACtB,KAAK;AACH,aAAO,2CAA2C,GAAG;AAAA,IACvD,KAAK;AACH,aAAO,2CAA2C,GAAG;AAAA,IACvD,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AACH,aAAO,iBAAiB,cAAc;AAAA,IACxC,SAAS;AACP;AACA,aAAO,iBAAiB,cAAqB;AAAA,IAC/C;AAAA,EACF;AACF;",
  "names": []
}
